@startuml
title Диаграмма вариантов использования

left to right direction

scale 0.8
skinparam Padding 3
skinparam ArrowThickness 1
skinparam DefaultFontSize 24

' Определение акторов (ролей)
actor "Пациент" as P
actor "Врач" as D
actor "Администратор\nсистемы" as SA
actor "Системный\nскрипт" as SS

rectangle "Система мониторинга здоровья" {

  ' Группируем варианты использования пациента
  package "Сценарии для Пациента" {
    usecase "Вход в систему" as UC1
    usecase "Просмотр списка\nназначений на\nсегодня" as UC2
    usecase "Выполнение\nназначения" as UC3
    usecase "Ручной ввод\nпоказателей" as UC4
    usecase "Получение\nуведомлений\nо назначениях" as UC5
    usecase "Переход к\nназначению" as UC6
  }

  ' Группируем варианты использования врача
  package "Сценарии для Врача" {
    usecase "Вход в систему" as UC7
    usecase "Просмотр карточки\nпациента" as UC8
    usecase "Просмотр прошлых\nзаписей о приёмах" as UC9
    usecase "Просмотр аналитики\nпоказателей" as UC10
    usecase "Просмотр назначений" as UC11
    usecase "Создание / редактирование\nзаписи о приёме" as UC12
    usecase "Создание / редактирование\nназначения" as UC13
  }

  ' Варианты использования, связанные с устройствами и администрированием
  package "Системные сценарии" {
    usecase "Автоматический\nсбор данных\nс носимых устройств" as UC14
    usecase "Анализ данных и\nвыявление аномалий" as UC15
    usecase "Настройка ролей и\nправ доступа" as UC16
    usecase "Заведение пациентов\nв систему" as UC17
  }
}

' Связи ПАЦИЕНТА
P --> UC1 
P --> UC2
P --> UC3 
P --> UC5

' Связи ВРАЧА
D --> UC7
D --> UC8 
D --> UC12 
D --> UC13 

' Связи АДМИНИСТРАТОРА
SA --> UC16
SA --> UC17

' Связь СИСТЕМНОГО СКРИПТА
UC14 <-- SS

' Дополнительные связи include/extend


' 1) "Ручной ввод показателей" (UC4) включает "Выполнение назначения" (UC3),
'    если обнаружены новые рекомендации (extend).
UC3 ..> UC4 : <<include>>

' 2) "Переход к назначению" (UC6) расширяет "Получение уведомлений о назначениях" (UC5)
UC5 <.. UC6 : <<extend>>

' 3) "Просмотр карточки пациента" (UC8) включает просмотр приёмов, назначений, аналитики показателей UC9, UC10, UC11
UC8 <.. UC9 : <<include>>
UC8 <.. UC10 : <<include>>
UC8 <.. UC11 : <<include>>

' 4) "Анализ данных и выявление аномалий" (UC15) выполняется по окончании дня, когда имеются собранные данные (UC14).
UC15 ..> UC14 : <<include>>
@enduml